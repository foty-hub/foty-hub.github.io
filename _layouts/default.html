<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} - {{ site.title }}</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    header { margin-bottom: 2rem; }
    .tab { overflow: hidden; border-bottom: 1px solid #ccc; }
    .tablinks { background-color: inherit; border: none; outline: none; cursor: pointer; padding: 0.5rem 1rem; transition: 0.3s; display: inline-block; text-decoration: none; color: inherit; }
    .tablinks:hover { background-color: #ddd; }
    .tablinks.active { background-color: #ccc; }
    .tabcontent { display: none; padding: 1rem 0; }
    main { max-width: {{ site.max_width | default: '820px' }};}
    article > .subtitle { margin-top: -0.5rem; margin-bottom: 1rem; color: #666; font-size: 1.1rem; line-height: 1.4; }
    @media (prefers-color-scheme: dark) { article > .subtitle { color: #9aa0a6; } }
    /* Research section layout */
    .research-list { display: grid; gap: 1.25rem; }
    .research-item { display: flex; align-items: flex-start; gap: 1rem; }
    .research-media { flex: 0 0 120px; width: 120px; height: 120px; border-radius: 8px; overflow: hidden; background: #e9ecef; }
    .research-media img, .research-media video { width: 100%; height: 100%; object-fit: cover; display: block; }
    .research-content h3 { margin: 0 0 0.25rem; font-size: 1.1rem; }
    .research-content p { margin: 0; }
    @media (max-width: 640px) {
      .research-item { flex-direction: column; }
      .research-media { width: 100%; height: auto; aspect-ratio: 1 / 1; }
    }
  </style>
  {{ content_for_header }}
  {% if page.math or site.math %}
    {% include math.html %}
  {% endif %}
</head>
<body>
  <header>
    <h1><a href="{{ site.baseurl }}/">{{ site.title }}</a></h1>
    {% include navbar.html %}
  </header>
  <main>
    {{ content }}
  </main>
  <footer>
    <p>&copy; {{ site.time | date: "%Y" }} {{ site.author.name }}</p>
  </footer>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var tabContents = document.querySelectorAll('.tabcontent');
      var navLinks = Array.prototype.slice.call(document.querySelectorAll('nav.tab .tablinks'));

      function setActiveLink(predicate) {
        navLinks.forEach(function(l){ l.classList.remove('active'); });
        var active = navLinks.find(predicate);
        if (active) active.classList.add('active');
      }

      // If this page has tab content (home), wire up in-page tabs
      if (tabContents.length > 0) {
        function showTab(id) {
          tabContents.forEach(function(c){ c.style.display = 'none'; });
          var el = document.getElementById(id);
          if (el) el.style.display = 'block';
          setActiveLink(function(l){ return (l.getAttribute('href') || '').endsWith('#' + id); });
        }

        // Click handlers on in-page links
        navLinks.forEach(function(link){
          var href = link.getAttribute('href') || '';
          if (href.indexOf('#') !== -1) {
            link.addEventListener('click', function(e){
              var hash = (link.hash || '').replace('#','');
              if (hash) {
                e.preventDefault();
                history.replaceState(null, '', '#' + hash);
                showTab(hash);
              }
            });
          }
        });

        // Initial tab: from hash or default to About
        var initial = (location.hash || '#About').replace('#','');
        showTab(initial);
      } else {
        // No tab contents present (e.g., blog pages): set active nav by path
        var path = location.pathname;
        if (path.indexOf('/blog') === 0) {
          setActiveLink(function(l){ return (l.getAttribute('href') || '').indexOf('/blog') !== -1; });
        } else {
          setActiveLink(function(l){ return (l.getAttribute('href') || '').replace(location.origin, '') === '/'; });
        }
      }
    });
  </script>
</body>
</html>

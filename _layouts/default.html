<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} - {{ site.title }}</title>
  <link rel="icon" href="{{ '/favicon/favicon.ico' | relative_url }}" sizes="any">
  <link rel="icon" href="{{ '/favicon/favicon.svg' | relative_url }}" type="image/svg+xml">
  <link rel="apple-touch-icon" href="{{ '/favicon/apple-touch-icon.png' | relative_url }}">
  <link rel="manifest" href="{{ '/favicon/site.webmanifest' | relative_url }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    /* Balanced prose rhythm with better inline-math behavior. */
    article,
    article p,
    article li {
      line-height: 1.6;
    }
    article ul,
    article ol {
      line-height: 1.6;
    }
    header { margin-bottom: 2rem; }
    .tab { overflow: hidden; border-bottom: 1px solid #ccc; }
    .tablinks { background-color: inherit; border: none; outline: none; cursor: pointer; padding: 0.5rem 1rem; transition: 0.3s; display: inline-block; text-decoration: none; color: inherit; }
    .tablinks:hover { background-color: #ddd; }
    .tablinks.active { background-color: #ccc; }
    .tabcontent { display: none; padding: 1rem 0; }
    main { max-width: {{ site.max_width | default: '820px' }};}
    article > .subtitle { margin-top: -0.5rem; margin-bottom: 1rem; color: #666; font-size: 1.1rem; line-height: 1.4; }
    @media (prefers-color-scheme: dark) { article > .subtitle { color: #9aa0a6; } }
    /* Shared media blocks used in posts (videos/SVG illustrations). */
    figure.media-block,
    figure.video,
    figure.illustration { margin: 1.25rem 0; max-width: 560px; }
    figure.media-block img,
    figure.media-block video,
    figure.video img,
    figure.video video,
    figure.illustration img,
    figure.illustration video { display: block; width: 100%; height: auto; border-radius: 6px; }
    figure.media-block figcaption,
    figure.video figcaption,
    figure.illustration figcaption { margin-top: 0.5rem; font-size: 0.95rem; line-height: 1.4; color: #666; text-align: center; }
    @media (prefers-color-scheme: dark) {
      figure.media-block figcaption,
      figure.video figcaption,
      figure.illustration figcaption { color: #9aa0a6; }
    }
    /* Research section layout */
    .research-list { display: grid; gap: 1.25rem; }
    .research-item { display: flex; align-items: flex-start; gap: 1rem; }
    .research-media { flex: 0 0 160px; width: 160px; height: 160px; border-radius: 8px; overflow: hidden; background: #e9ecef; }
    .research-media img, .research-media video { width: 100%; height: 100%; object-fit: cover; display: block; }
    .research-content h3 { margin: 0 0 0.25rem; font-size: 1.1rem; }
    .research-content p { margin: 0; }
    @media (max-width: 640px) {
      .research-item { flex-direction: column; }
      .research-media { width: 100%; height: auto; aspect-ratio: 1 / 1; }
    }
    /* Section spacing - a few line breaks */
    main section { margin-top: 5em; }
    main section:first-of-type { margin-top: 0; }
    @media (max-width: 640px) {
      main section { margin-top: 5em; }
    }
    /* Footer social icons */
    .site-footer { display: flex; align-items: center; justify-content: space-between; margin-top: 3rem; padding-top: 1rem; border-top: 1px solid #ccc; }
    .social-icons { display: flex; gap: 0.75rem; }
    .social-icons a { display: inline-flex; width: 22px; height: 22px; align-items: center; justify-content: center; text-decoration: none; }
    .social-icons img { width: 22px; height: 22px; display: block; filter: brightness(0) saturate(100%); opacity: 0.9; transition: opacity .15s ease-in-out; }
    .social-icons a:hover img { opacity: 1; }
    @media (prefers-color-scheme: dark) {
      .site-footer { border-top-color: #444; }
    }
  </style>
  {{ content_for_header }}
  {% if page.math or site.math %}
    {% include math.html %}
  {% endif %}
</head>
<body>
  <header>
    <h1><a href="{{ site.baseurl }}/">{{ site.title }}</a></h1>
    {% include navbar.html %}
  </header>
  <main>
    {{ content }}
  </main>
  <footer class="site-footer">
    <p>&copy; {{ site.time | date: "%Y" }} {{ site.author.name }}</p>
    <nav class="social-icons" aria-label="Social links">
      {% assign social = site.social %}
      {% if social.linkedin %}
        <a href="{{ social.linkedin }}" aria-label="LinkedIn" target="_blank" rel="me noopener noreferrer">
          <img src="{{ '/assets/icons/linkedin.svg' | relative_url }}" alt="LinkedIn">
        </a>
      {% endif %}
      {% if social.github %}
        <a href="{{ social.github }}" aria-label="GitHub" target="_blank" rel="me noopener noreferrer">
          <img src="{{ '/assets/icons/github.svg' | relative_url }}" alt="GitHub">
        </a>
      {% endif %}
      {% if social.x %}
        <a href="{{ social.x }}" aria-label="X" target="_blank" rel="me noopener noreferrer">
          <img src="{{ '/assets/icons/x.svg' | relative_url }}" alt="X">
        </a>
      {% endif %}
      {% if social.bluesky %}
        <a href="{{ social.bluesky }}" aria-label="Bluesky" target="_blank" rel="me noopener noreferrer">
          <img src="{{ '/assets/icons/bluesky.svg' | relative_url }}" alt="Bluesky">
        </a>
      {% endif %}
    </nav>
  </footer>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var tabContents = document.querySelectorAll('.tabcontent');
      var navLinks = Array.prototype.slice.call(document.querySelectorAll('nav.tab .tablinks'));

      function setActiveLink(predicate) {
        navLinks.forEach(function(l){ l.classList.remove('active'); });
        var active = navLinks.find(predicate);
        if (active) active.classList.add('active');
      }

      // If this page has tab content (home), wire up in-page tabs
      if (tabContents.length > 0) {
        function showTab(id) {
          tabContents.forEach(function(c){ c.style.display = 'none'; });
          var el = document.getElementById(id);
          if (el) el.style.display = 'block';
          setActiveLink(function(l){ return (l.getAttribute('href') || '').endsWith('#' + id); });
        }

        // Click handlers on in-page links
        navLinks.forEach(function(link){
          var href = link.getAttribute('href') || '';
          if (href.indexOf('#') !== -1) {
            link.addEventListener('click', function(e){
              var hash = (link.hash || '').replace('#','');
              if (hash) {
                e.preventDefault();
                history.replaceState(null, '', '#' + hash);
                showTab(hash);
              }
            });
          }
        });

        // Initial tab: from hash or default to About
        var initial = (location.hash || '#About').replace('#','');
        showTab(initial);
      } else {
        // No tab contents present (e.g., blog pages): set active nav by path
        var path = location.pathname;
        if (path.indexOf('/blog') === 0) {
          setActiveLink(function(l){ return (l.getAttribute('href') || '').indexOf('/blog') !== -1; });
        } else {
          setActiveLink(function(l){ return (l.getAttribute('href') || '').replace(location.origin, '') === '/'; });
        }
      }
    });
  </script>
</body>
</html>
